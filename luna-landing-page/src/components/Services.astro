---
import { Image } from 'astro:assets';
import book1 from '../assets/images/books/book1.webp';
import book2 from '../assets/images/books/book2.webp';
import book3 from '../assets/images/books/book3.webp';
import book4 from '../assets/images/books/book4.webp';
---

<section class="books-section w-full bg-gradient-to-br from-gray-900 via-gray-800 to-black py-16 md:py-[180px] px-7 md:px-30">
    <div class="max-w-6xl mx-auto flex flex-col md:flex-row md:items-start gap-8 md:gap-16">

        <!-- Left column -->
        <div class="md:w-2/5 flex flex-col gap-6 text-white">
            <h2 class="font-display text-[55px] md:text-[60px] text-center md:text-start font-bold leading-[1.1] text-blue-400">
                Bestselling
                <span class="block text-[50px] md:text-[55px] text-blue-400 font-extrabold tracking-wide">BOOKS</span>
            </h2>
            <p class="hidden lg:block md:text-[17px] leading-relaxed tracking-wide text-gray-100">
                Estos libros fueron creados para acompañarte en tu proceso de aprendizaje y transformación profesional.
            </p>
        </div>

        <!-- Right column -->
        <div class="md:w-3/5 flex flex-col gap-6">
            <div class="books-viewport w-full overflow-hidden">
                <div class="books-track inline-flex flex-nowrap gap-8 items-start">

                   <!-- Book 1 - Marketing -->
<article class="book flex flex-col items-center flex-shrink-0 w-[340px] sm:w-[300px] md:w-[360px] h-[520px] bg-blue-600 p-4 rounded-xl text-white book-card">
    <Image 
        src={book1}
        alt="Portada Guía de Marketing Digital"
        width={250}
        height={300}
        loading="lazy"
        class="w-[180px] h-[270px] md:w-[200px] md:h-[290px] object-cover rounded-md shadow-lg"
    />
    <h3 class="text-[25px] md:text-[25px] font-bold text-center leading-tight mt-3 mb-3">Guía de Marketing</h3>
    <p class="text-[13px] md:text-[15px] text-white/100 text-center px-2 line-clamp-2 leading-snug">
        Aprende desde los fundamentos hasta las estrategias avanzadas de marketing digital.
    </p>
    <button class="mt-8 bg-white text-blue-600 rounded-md px-10 py-3 font-bold hover:bg-blue-100 transition shadow-md text-[14px]">
        Comprar
    </button>
</article>

<!-- Book 2 - Ventas -->
<article class="book flex flex-col items-center flex-shrink-0 w-[340px] sm:w-[300px] md:w-[360px] h-[520px] bg-indigo-600 p-4 rounded-xl text-white book-card">
    <Image 
        src={book2}
        alt="Portada Guía de Ventas Efectivas"
        width={250}
        height={300}
        loading="lazy"
        class="w-[180px] h-[270px] md:w-[200px] md:h-[290px] object-cover rounded-md shadow-lg"
    />
    <h3 class="text-[25px] md:text-[25px] font-bold text-center leading-tight mt-3 mb-3">Guía de Ventas</h3>
    <p class="text-[13px] md:text-[15px] text-white/100 text-center px-2 line-clamp-2 leading-snug">
        Aprende estrategias efectivas para aumentar tus ventas y cerrar más tratos.
    </p>
    <button class="mt-8 bg-white text-indigo-600 rounded-md px-10 py-3 font-bold hover:bg-indigo-100 transition shadow-md text-[14px]">
        Comprar
    </button>
</article>

<!-- Book 3 - Productividad -->
<article class="book flex flex-col items-center flex-shrink-0 w-[340px] sm:w-[300px] md:w-[360px] h-[520px] bg-slate-700 p-4 rounded-xl text-white book-card">
    <Image 
        src={book3}
        alt="Portada Guía de Productividad Personal"
        width={250}
        height={300}
        loading="lazy"
        class="w-[180px] h-[270px] md:w-[200px] md:h-[290px] object-cover rounded-md shadow-lg"
    />
    <h3 class="text-[25px] md:text-[25px] font-bold text-center leading-tight mt-3 mb-3">Guía de Productividad</h3>
    <p class="text-[13px] md:text-[15px] text-white/100 text-center px-2 line-clamp-2 leading-snug">
        Aprende a organizar tu tiempo y aumentar tu productividad de manera efectiva.
    </p>
    <button class="mt-8 bg-white text-slate-700 rounded-md px-10 py-3 font-bold hover:bg-slate-100 transition shadow-md text-[14px]">
        Comprar
    </button>
</article>

<!-- Book 4 - Finanzas -->
<article class="book flex flex-col items-center flex-shrink-0 w-[340px] sm:w-[300px] md:w-[360px] h-[520px] bg-cyan-600 p-4 rounded-xl text-white book-card">
    <Image 
        src={book4}
        alt="Portada Guía de Finanzas Personales"
        width={250}
        height={300}
        loading="lazy"
        class="w-[180px] h-[270px] md:w-[200px] md:h-[290px] object-cover rounded-md shadow-lg"
    />
    <h3 class="text-[25px] md:text-[25px] font-bold text-center leading-tight mt-3 mb-3">Guía de Finanzas</h3>
    <p class="text-[13px] md:text-[15px] text-white/100 text-center px-2 line-clamp-2 leading-snug">
        Domina los conceptos financieros esenciales para gestionar mejor tu dinero.
    </p>
    <button class="mt-8 bg-white text-cyan-600 rounded-md px-10 py-3 font-bold hover:bg-cyan-100 transition shadow-md text-[14px]">
        Comprar
    </button>
</article>


                </div>
            </div>
        </div>

    </div>
</section>

<script type="module">
    import gsap from "https://cdn.jsdelivr.net/npm/gsap@3.12.5/index.js";
    import { ScrollTrigger } from "https://cdn.jsdelivr.net/npm/gsap@3.12.5/ScrollTrigger.js";
    gsap.registerPlugin(ScrollTrigger);

    const section = document.querySelector('.books-section');
    const track = section.querySelector('.books-track');
    const viewport = section.querySelector('.books-viewport');

    function initHorizontalScroll() {
        ScrollTrigger.getAll().forEach(t => t.kill());
        gsap.set(track, { x: 0 });

        const trackWidth = track.scrollWidth;
        const viewportWidth = viewport.offsetWidth;
        const distance = trackWidth - viewportWidth;

        if (distance <= 0) return;

        gsap.to(track, {
            x: -distance,
            ease: "none",
            scrollTrigger: {
                trigger: section,
                start: "top -5%",
                end: `+=${distance + viewportWidth}`,
                scrub: true,
                pin: true,
                anticipatePin: 1,
            }
        });
    }

    setTimeout(initHorizontalScroll, 100);

    let resizeTimeout;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(initHorizontalScroll, 250);
    });
</script>